<script type="text/javascript"> 

var chart1, chart2, chart3, chart4, chart5;

<% { "1" => 1, "2" => 2, "3" => 3, "4" => 4, "5" => 5 }.each do |name, index| %>

jQuery(document).ready(function() {
	chart<%= name %> = new Highcharts.Chart({
		chart: {
			renderTo: 'measure<%= name %>graph',
			defaultSeriesType: 'line'
		},
		title: {
			text: 'Historical Values',
			x: -20 //center
		},
		xAxis: {
			categories: <%= date_values(@performance_test_results) %>,
			labels: { rotation: -45, align: 'right'}
		},
		yAxis: {
			title: {
				text: 'Time (seconds)'
			},
			plotLines: [{
				value: 0,
				width: 1,
				color: '#808080'
			}]
		},
		tooltip: {
			formatter: function() {
	                return '<b>'+ this.series.name +'</b><br/>'+
					this.x +': '+ this.y +' sec';
			}
		},
		legend: {
			backgroundColor: '#FFFFFF',
			reversed: true
		},
		series: [{
			name: 'Max',
			data: <%= max_values(@performance_test_results, index ) %>
		}, {
			name: 'Average',
			data: <%= avg_values(@performance_test_results, index ) %>
		} , {
			name: 'Min',
			data: <%= min_values(@performance_test_results, index ) %>
		}
		]
	});
	
	
});

<% end %>


</script>





<p>
  <b>Performance Test Name:</b>
  <%= @performance_test.name %>
</p>

<p>
  <b>Measure1:</b>
  <%= @performance_test.measure1name %>
</p>

<div id="measure1graph" style="width:600px;height:300px;"></div> 

<table class="bvt_app_small_table">
 	<thead>
  <tr class="yellow">
    <th>Date</th>
	<th>Build</th>
    <th>Max</th>
    <th>Min</th>
	<th>Average</th>
	<th></th>
  </tr>
	</thead>
	<tbody>
<% @performance_test_results.each do |performance_test_result| %>
  <tr>
	<td><%= format_date_string performance_test_result.date_run %></td>
	<td><%= performance_test_result.build %>
    <td><%= performance_test_result.measure1max %></td>
	<td><%= performance_test_result.measure1min %></td>
    <td><%= performance_test_result.measure1avg %></td>
    <td><%= link_to 'Details', performance_test_result %></td>
  </tr>
<% end %>
	</tbody>
</table>

<% unless @performance_test.measure2name == nil or @performance_test.measure2name.strip == "" %>
<p>&nbsp;</p>
<p>
  <b>Measure 2:</b>
  <%= @performance_test.measure2name %>
</p>
<div id="measure2graph" style="width:600px;height:300px;"></div> 
<table class="bvt_app_small_table">
 	<thead>
  <tr class="yellow">
    <th>Date</th>
	<th>Build</th>
    <th>Max</th>
    <th>Min</th>
	<th>Average</th>
	<th></th>
  </tr>
	</thead>
	<tbody>
<% @performance_test_results.each do |performance_test_result| %>
  <% unless performance_test_result.measure2max == nil and performance_test_result.measure2min == nil and performance_test_result.measure2avg == nil %>
  <tr>
	<td><%= format_date_string performance_test_result.date_run %></td>
	<td><%= performance_test_result.build %>
    <td><%= performance_test_result.measure2max %></td>
	<td><%= performance_test_result.measure2min %></td>
    <td><%= performance_test_result.measure2avg %></td>
    <td><%= link_to 'Details', performance_test_result %></td>
  </tr>
  <% end %>
<% end %>
	</tbody>
</table>
<% end %>

<% unless @performance_test.measure3name == nil or @performance_test.measure3name.strip == "" %>
<p>&nbsp;</p>
<p>
  <b>Measure 3:</b>
  <%= @performance_test.measure3name %>
</p>
<div id="measure3graph" style="width:600px;height:300px;"></div> 
<table class="bvt_app_small_table">
 	<thead>
  <tr class="yellow">
    <th>Date</th>
	<th>Build</th>
    <th>Max</th>
    <th>Min</th>
	<th>Average</th>
	<th></th>
  </tr>
	</thead>
	<tbody>
<% @performance_test_results.each do |performance_test_result| %>
   <% unless performance_test_result.measure3max == nil and performance_test_result.measure3min == nil and performance_test_result.measure3avg == nil %>
  <tr>
	<td><%= format_date_string performance_test_result.date_run %></td>
	<td><%= performance_test_result.build %>
    <td><%= performance_test_result.measure3max %></td>
	<td><%= performance_test_result.measure3min %></td>
    <td><%= performance_test_result.measure3avg %></td>
    <td><%= link_to 'Details', performance_test_result %></td>
  </tr>
  <% end %>
<% end %>
	</tbody>
</table>
<% end %>

<% unless @performance_test.measure4name == nil or @performance_test.measure4name.strip == "" %>

<p>&nbsp;</p>
<p>
  <b>Measure 4:</b>
  <%= @performance_test.measure4name %>
</p>
<div id="measure4graph" style="width:600px;height:300px;"></div> 
<table class="bvt_app_small_table">
 	<thead>
  <tr class="yellow">
    <th>Date</th>
	<th>Build</th>
    <th>Max</th>
    <th>Min</th>
	<th>Average</th>
	<th></th>
  </tr>
	</thead>
	<tbody>
<% @performance_test_results.each do |performance_test_result| %>
  <% unless performance_test_result.measure4max == nil and performance_test_result.measure4min == nil and performance_test_result.measure4avg == nil %>
  <tr>
	<td><%= format_date_string performance_test_result.date_run %></td>
	<td><%= performance_test_result.build %>
    <td><%= performance_test_result.measure4max %></td>
	<td><%= performance_test_result.measure4min %></td>
    <td><%= performance_test_result.measure4avg %></td>
    <td><%= link_to 'Details', performance_test_result %></td>
  </tr>
  <% end %>
<% end %>
	</tbody>
</table>
<% end %>

<% unless @performance_test.measure5name == nil or @performance_test.measure5name.strip == "" %>
<div id="measure5graph" style="width:600px;height:300px;"></div> 
<p> </p>
<p>
  <b>Measure 5:</b>
  <%= @performance_test.measure5name %>
</p>
<table class="bvt_app_small_table">
 	<thead>
  <tr class="yellow">
    <th>Date</th>
	<th>Build</th>
    <th>Max</th>
    <th>Min</th>
	<th>Average</th>
	<th></th>
  </tr>
	</thead>
	<tbody>
<% @performance_test_results.each do |performance_test_result| %>
  <% unless performance_test_result.measure5max == nil and performance_test_result.measure5min == nil and performance_test_result.measure5avg == nil %>
  <tr>
	<td><%= format_date_string performance_test_result.date_run %></td>
	<td><%= performance_test_result.build %>
    <td><%= performance_test_result.measure5max %></td>
	<td><%= performance_test_result.measure5min %></td>
    <td><%= performance_test_result.measure5avg %></td>
    <td><%= link_to 'Details', performance_test_result %></td>
  </tr>
  <% end %>
<% end %>
	</tbody>
</table>
<% end %>

<%= link_to "Add Test Result", add_test_result_performance_test_path, :method=> :put %>
